<div class="container">
  <h2>Crear Nuevo Videojuego</h2>

  <form [formGroup]="nuevoVideojuego" (ngSubmit)="submit()">
    <div class="row">
      <div class="col-sm-6">
        <label class="form-label">Título del Videojuego</label>
        <input
          type="text"
          class="form-control"
          formControlName="titulo"
          placeholder="Ej: The Legend of Zelda"
        />
      </div>

      <div class="col-sm-6">
        <label class="form-label">Precio (Q.)</label>
        <input
          type="number"
          class="form-control"
          formControlName="precio"
          placeholder="199.99"
          step="0.01"
          min="0"
        />
      </div>

      <div class="col-12">
        <label class="form-label">Descripción</label>
        <textarea
          class="form-control"
          formControlName="descripcion"
          rows="3"
          placeholder="Describe el videojuego, su historia, características principales..."
        ></textarea>
      </div>

      <div class="col-sm-6">
        <label class="form-label">Fecha de Lanzamiento</label>
        <input type="date" class="form-control" formControlName="fechaLanzamiento" />
      </div>

      <div class="col-sm-6">
        <label class="form-label">Clasificación</label>
        <select class="form-control" formControlName="clasificacion">
          <option value="" disabled>Selecciona una clasificación</option>
          <option value="E">E - Everyone (Todos)</option>
          <option value="E10+">E10+ - Everyone 10+ (Todos 10+)</option>
          <option value="T">T - Teen (Adolescentes)</option>
          <option value="M">M - Mature (Maduro)</option>
          <option value="AO">AO - Adults Only (Solo Adultos)</option>
        </select>
      </div>

      <div class="col-12">
        <label class="form-label">Recursos Mínimos</label>
        <textarea
          class="form-control"
          formControlName="recursosMinimos"
          rows="3"
          placeholder="Ej: CPU: Intel i5-8400, RAM: 8GB, GPU: GTX 1060, Storage: 50GB"
        ></textarea>
      </div>

      <div class="col-12">
        <h4>Categorías</h4>
      </div>

      <div class="col-12">
        <div class="categoria-input-group">
          <input
            type="text"
            class="form-control categoria-input"
            [(ngModel)]="nuevaCategoria"
            placeholder="Escriba una categoría (ej: Acción, Aventura, RPG...)"
            (keyup.enter)="agregarCategoria()"
          />
          <button
            type="button"
            class="btn-add-categoria"
            (click)="agregarCategoria()"
            [disabled]="!nuevaCategoria.trim()"
          >
            Agregar
          </button>
        </div>

        <div class="categorias-agregadas" *ngIf="categoriasSeleccionadas.length > 0">
          <div
            class="categoria-tag"
            *ngFor="let categoria of categoriasSeleccionadas; let i = index"
          >
            <span>{{ categoria }}</span>
            <button type="button" class="btn-remove-categoria" (click)="eliminarCategoria(i)">
              ×
            </button>
          </div>
        </div>
      </div>

      <div class="col-12">
        <label class="form-label">Imagen del Videojuego</label>
        <input
          type="file"
          class="form-control"
          (change)="onFileSelected($event)"
          accept="image/png, image/jpeg, image/jpg"
        />
      </div>

      <div class="col-12">
        <div class="button-group">
          <button type="submit" class="btn-primary" [disabled]="!nuevoVideojuego.valid">
            Registrar Videojuego
          </button>
          <button type="button" class="btn-secondary" (click)="resetFormulario()">Limpiar</button>
          <button type="button" class="btn-secondary" (click)="regresar()">Regresar</button>
        </div>
      </div>
    </div>
  </form>
</div>

<app-share-popup
  [mensaje]="infoMessage || ''"
  [tipo]="popupTipo"
  [mostrar]="popupMostrar"
  (cerrarEvent)="popupMostrar = false"
></app-share-popup>
